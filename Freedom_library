local UILibrary = {}

-- Function: สร้างหน้าต่างหลัก
function UILibrary:CreateWindow(config)
    local ScreenGui = Instance.new("ScreenGui")
    local ToggleButton = Instance.new("TextButton")
    local MainFrame = Instance.new("Frame")
    local UICorner = Instance.new("UICorner")
    local TopBar = Instance.new("Frame")
    local TabsHolder = Instance.new("Frame")
    local TabContainer = Instance.new("Frame")
    local UIListLayout = Instance.new("UIListLayout")

    -- Parent
    ScreenGui.Name = config.Name or "UI_Library"
    ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

    -- Toggle Button
    ToggleButton.Name = "ToggleButton"
    ToggleButton.Size = UDim2.new(0, 100, 0, 50)
    ToggleButton.Position = UDim2.new(0, 10, 0, 10)
    ToggleButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    ToggleButton.Text = "Toggle UI"
    ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    ToggleButton.Font = Enum.Font.SourceSans
    ToggleButton.TextSize = 14
    ToggleButton.Parent = ScreenGui

    -- Main Frame
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, config.Width or 500, 0, config.Height or 400)
    MainFrame.Position = UDim2.new(0.5, -(config.Width or 500) / 2, 0.5, -(config.Height or 400) / 2)
    MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    MainFrame.Visible = true
    MainFrame.Parent = ScreenGui

    -- UICorner
    UICorner.CornerRadius = UDim.new(0, 10)
    UICorner.Parent = MainFrame

    -- Top Bar
    TopBar.Name = "TopBar"
    TopBar.Size = UDim2.new(1, 0, 0, 40)
    TopBar.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    TopBar.Parent = MainFrame

    -- Tabs Holder
    TabsHolder.Name = "TabsHolder"
    TabsHolder.Size = UDim2.new(0, 100, 1, -40)
    TabsHolder.Position = UDim2.new(0, 0, 0, 40)
    TabsHolder.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    TabsHolder.Parent = MainFrame

    -- Tab Container
    TabContainer.Name = "TabContainer"
    TabContainer.Size = UDim2.new(1, -100, 1, -40)
    TabContainer.Position = UDim2.new(0, 100, 0, 40)
    TabContainer.BackgroundTransparency = 1
    TabContainer.Parent = MainFrame

    -- UIListLayout
    UIListLayout.Name = "UIListLayout"
    UIListLayout.FillDirection = Enum.FillDirection.Vertical
    UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    UIListLayout.Parent = TabsHolder

    -- Toggle Visibility
    ToggleButton.MouseButton1Click:Connect(function()
        MainFrame.Visible = not MainFrame.Visible
    end)

    local Window = {
        ScreenGui = ScreenGui,
        MainFrame = MainFrame,
        TabContainer = TabContainer,
        TabsHolder = TabsHolder,
        Tabs = {}
    }

    return setmetatable(Window, { __index = UILibrary })
end

-- Function: สร้าง Tab ใหม่
function UILibrary:AddTab(name)
    local TabButton = Instance.new("TextButton")
    local TabFrame = Instance.new("Frame")

    -- Tab Button
    TabButton.Name = name
    TabButton.Text = name
    TabButton.Size = UDim2.new(1, 0, 0, 40)
    TabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    TabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    TabButton.Font = Enum.Font.SourceSans
    TabButton.TextSize = 16
    TabButton.Parent = self.TabsHolder

    -- Tab Frame
    TabFrame.Name = name
    TabFrame.Size = UDim2.new(1, 0, 1, 0)
    TabFrame.BackgroundTransparency = 1
    TabFrame.Visible = false
    TabFrame.Parent = self.TabContainer

    -- สลับ Tab
    TabButton.MouseButton1Click:Connect(function()
        for _, frame in pairs(self.TabContainer:GetChildren()) do
            if frame:IsA("Frame") then
                frame.Visible = false
            end
        end
        TabFrame.Visible = true
    end)

    self.Tabs[name] = TabFrame
    return TabFrame
end

-- Function: เพิ่มปุ่มใน Tab
function UILibrary:AddButton(tabName, buttonConfig)
    local Tab = self.Tabs[tabName]
    if not Tab then
        warn("Tab not found: " .. tabName)
        return
    end

    local Button = Instance.new("TextButton")
    Button.Name = buttonConfig.Name or "Button"
    Button.Text = buttonConfig.Text or "Click Me"
    Button.Size = UDim2.new(0, 200, 0, 50)
    Button.Position = UDim2.new(0.5, -100, 0, #Tab:GetChildren() * 60)
    Button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    Button.TextColor3 = Color3.fromRGB(255, 255, 255)
    Button.Font = Enum.Font.SourceSans
    Button.TextSize = 14
    Button.Parent = Tab

    Button.MouseButton1Click:Connect(buttonConfig.Callback or function()
        print(Button.Text .. " clicked!")
    end)

    return Button
end

return UILibrary